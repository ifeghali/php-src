## Process this file with automake to produce Makefile.in -*- makefile -*-

#CLEANFILES = zend-parser.c zend-parser.h zend-scanner.c zend-parser.output 

AUTOMAKE_OPTIONS=foreign
EXTRA_LTLIBRARIES=libZend_cc.la libZend_c.la
noinst_LTLIBRARIES=$(ZEND_SCANNER) libZend.la

libZend_cc_la_SOURCES=zend-scanner-cc.cc
libZend_c_la_SOURCES=zend-scanner.c

libZend_la_SOURCES=\
	zend-parser.y \
	zend_alloc.c zend_compile.c zend_constants.c zend_dynamic_array.c \
	zend_execute.c zend_execute_API.c zend_highlight.c zend_llist.c \
	zend_opcode.c zend_operators.c zend_ptr_stack.c zend_stack.c \
	zend_variables.c zend.c zend_API.c zend_extensions.c zend_hash.c \
	zend_list.c zend_indent.c zend_builtin_functions.c zend_sprintf.c

libZend_la_LIBADD = $(ZEND_SCANNER)
libZend_la_LDFLAGS = @EXTRA_LIBS@
libZend_la_DEPENDENCIES = $(ZEND_SCANNER)

# automake isn't too clever about "non-standard" use of lex and yacc

$(libZend_la_OBJECTS) zend-scanner.lo zend-scanner-cc.lo: zend-parser.h

zend-scanner.c: $(srcdir)/zend-scanner.l
	$(LEX) -Pzend -o$@ -i $(srcdir)/zend-scanner.l

zend-scanner-cc.cc: $(srcdir)/zend-scanner.l
	$(LEX) -+ -B -i -S$(srcdir)/flex.skl -Pzend -o$@ $(srcdir)/zend-scanner.l

zend-parser.h: zend-parser.c
zend-parser.c: $(srcdir)/zend-parser.y
	$(YACC) -p zend -v -d $(srcdir)/zend-parser.y -o zend-parser.c

depend:

zend_execute.lo: $(srcdir)/zend_execute.c
	$(LIBTOOL) --mode=compile $(CC) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(INLINE_CFLAGS) -c $(srcdir)/zend_execute.c
